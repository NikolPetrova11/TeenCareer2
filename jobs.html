<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <title>–¢—ä—Ä—Å–∞—á–∫–∞ –Ω–∞ –æ–±—è–≤–∏ –∑–∞ —Ä–∞–±–æ—Ç–∞</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f3f4f6; padding: 20px; }
    h1 { color: #333; }
    input, button { padding: 8px; margin: 5px; }
    ul { list-style-type: none; padding: 0; }
    li { background: #fff; margin-bottom: 8px; padding: 10px; border-radius: 8px; }
    a { color: #007BFF; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>üîç –ù–∞–º–µ—Ä–∏ —Ä–∞–±–æ—Ç–∞</h1>
  <input id="role" placeholder="–ü—Ä–æ—Ñ–µ—Å–∏—è (–Ω–∞–ø—Ä. –±–∞—Ä–º–∞–Ω)" value="–ë–∞—Ä–º–∞–Ω">
  <input id="city" placeholder="–ì—Ä–∞–¥ (–Ω–∞–ø—Ä. –°–æ—Ñ–∏—è)" value="–°–æ—Ñ–∏—è">
  <button onclick="getJobs()">–î–∞ –¥–µ–π—Å—Ç–≤–∞–º–µ!</button>

  <div id="results" style="margin-top:20px;"></div>

<script>
async function getJobs() {
  const role = document.getElementById("role").value;
  const city = document.getElementById("city").value;
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "‚è≥ –¢—ä—Ä—Å–µ–Ω–µ...";

  // –°–∞–π—Ç JobTiger
  const url = `https://www.jobtiger.bg/obiavi-za-rabota/?q=${encodeURIComponent(role)}&l=${encodeURIComponent(city)}`;
  const proxy = `http://localhost/TeenCareer2/proxy.php?url=${encodeURIComponent(url)}`;

  try {
    const response = await fetch(proxy);
    const html = await response.text();

    const parser = new DOMParser();
    const doc = parser.parseFromString(html, "text/html");

    // –¢—ä—Ä—Å–∏–º –µ–ª–µ–º–µ–Ω—Ç–∏ —Å –ª–∏–Ω–∫–æ–≤–µ –∫—ä–º –æ–±—è–≤–∏
    const jobs = doc.querySelectorAll("a.job-title");

    if (jobs.length === 0) {
      resultsDiv.innerHTML = "‚ùå –ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –æ–±—è–≤–∏.";
      return;
    }

    let output = `<h2>–û–±—è–≤–∏ –∑–∞ ${role} –≤ ${city}</h2><ul>`;
    jobs.forEach(job => {
      const title = job.textContent.trim();
      const link = job.href.startsWith("http") ? job.href : `https://www.jobtiger.bg${job.getAttribute("href")}`;
      output += `<li><a href="${link}" target="_blank">${title}</a></li>`;
    });
    output += "</ul>";

    resultsDiv.innerHTML = output;

  } catch (err) {
    resultsDiv.innerHTML = "‚ö†Ô∏è –ì—Ä–µ—à–∫–∞: " + err;
  }
}
</script>
</body>
</html>
